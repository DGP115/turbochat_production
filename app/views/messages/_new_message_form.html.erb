<div class="form-group msg-form">
  <%= form_with(model: [@current_room, @message], remote: true, class: "d-flex",
                        data: { controller: "reset-form",
                                action: "turbo:submit-end->reset-form#reset"}) do |f| %>

    <div id="attachment-previews" data-controller="message-preview"
                                  data-action="message-preview#preview"
                                  class="d-none">
    </div>

    <div class="image-upload">

      <%= f.file_field(:attachments, multiple: true,
                        data:{ controller: "message-preview",
                               action: "change->message-preview#preview" }) %>
                                <!-- action: on-the-change-event (so when the upload is complete), the controller is message-preview, call action preview-->
    </div>

    <%= f.text_field :body, id: "chat-text", class: "form-control msg-content",
                      autocomplete: "off" %>

    <%= f.submit "Send",
                  data: { disable_with: false,
                          controller: "message-preview",
                          action: "click->message-preview#clearPreviews" },
                  class: "btn btn-primary" %>

  <% end %>
</div>
